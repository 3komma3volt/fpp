/**
 * jQuery Real Ajax Uploader 2.7
 * http://www.albanx.com/
 *
 * Copyright 2010-2013, Alban Xhaferllari
 *
 * Date: 12-05-2013
 */

(function(d){function f(a){return p?p[r[a]]||a:a}var r={"Add files":0,"Start upload":1,"Remove all":2,Close:3,"Select Files":4,Preview:5,"Remove file":6,Bytes:7,KB:8,MB:9,GB:10,"Upload aborted":11,"Upload all files":12,"Select Files or Drag&Drop Files":13,"File uploaded 100%":14,"Max files number reached":15,"Extension not allowed":16,"File size now allowed":17},s={it_IT:"Aggiungi file;Inizia caricamento;Rimuvi tutti;Chiudi;Seleziona;Anteprima;Rimuovi file;Bytes;KB;MB;GB;Interroto;Carica tutto;Seleziona o Trascina qui i file;File caricato 100%;Numero massimo di file superato;Estensione file non permessa;Dimensione file non permessa".split(";"), sq_AL:"Shto file;Fillo karikimin;Hiqi te gjith\u00eb;Mbyll;Zgjith filet;Miniatur\u00eb;Hiqe file-in;Bytes;KB;MB;GB;Karikimi u nd\u00ebrpre;Kariko t\u00eb gjith\u00eb;Zgjith ose Zvarrit dokumentat k\u00ebtu;File u karikua 100%".split(";"),nl_NL:"Bestanden toevoegen;Start uploaden;Verwijder alles;Sluiten;Selecteer bestanden;Voorbeeld;Verwijder bestand;Bytes;KB;MB;GB;Upload afgebroken;Upload alle bestanden;Selecteer bestanden of Drag&Drop bestanden;Bestand ge\u00fcpload 100%".split(";"),de_DE:"Dateien hinzuf\u00fcgen;Hochladen;Alle entfernen;Schliessen;Dateien w\u00e4hlen;Vorschau;Datei entfernen;Bytes;KB;MB;GB;Upload abgebrochen;Alle hochgeladen;W\u00e4hlen Sie Dateien oder f\u00fcgen Sie sie mit Drag & Drop hinzu.;Upload 100%".split(";"), fr_FR:"Ajouter;Envoyer;Tout supprimer;Fermer;Parcourir;Visualiser;Supprimer fichier;Bytes;Ko;Mo;Go;Envoi annul\u00e9;Tout envoyer;Parcourir ou Glisser/D\u00e9poser;Fichier envoy\u00e9 100%".split(";")},p={},g=function(a,b,c,e,h){this.file=a;this.status=this.currentByte=0;this.name=b;this.size=c;this.info=this.xhr=null;this.ext=e;this.pos=h.files.length;this.AU=h;e=h.settings;c=this.sizeFormat();this.li=d("<li />").appendTo(this.AU.fileList).attr("title",b);e.bootstrap&&(this.li=d("<a />").appendTo(this.li)); this.prevContainer=d('<a class="ax-prev-container" />').appendTo(this.li);this.prevImage=d('<img class="ax-preview" src="" alt="'+f("Preview")+'" />').appendTo(this.prevContainer);this.details=d('<div class="ax-details" />').appendTo(this.li);this.nameContainer=d('<div class="ax-file-name">'+b+"</div>").appendTo(this.details);this.sizeContainer=d('<div class="ax-file-size">'+c+"</div>").appendTo(this.details);this.progressInfo=d('<div class="ax-progress" />').appendTo(this.li);this.progressBar=d('<div class="ax-progress-bar" />').appendTo(this.progressInfo); this.progressPer=d('<div class="ax-progress-info">0%</div>').appendTo(this.progressInfo);this.buttons=d('<div class="ax-toolbar" />').appendTo(this.li);this.uploadButton=d('<a title="'+f("Start upload")+'" class="ax-upload ax-button" />').appendTo(this.buttons).append('<span class="ax-upload-icon ax-icon"></span>');this.removeButton=d('<a title="Remove file" class="ax-remove ax-button" />').appendTo(this.buttons).append('<span class="ax-clear-icon ax-icon"></span>');e.bootstrap&&(this.li.addClass("media thumbnail"), this.prevContainer.addClass("pull-left"),this.prevImage.addClass("img-rounded media-object"),this.details.addClass("label label-info").css({"border-bottom-left-radius":0}),this.progressInfo.addClass("progress progress-striped active").css({"margin-bottom":0}),this.progressBar.addClass("bar"),this.buttons.addClass("label label-info").css({"border-top-left-radius":0,"border-top-right-radius":0}),this.uploadButton.addClass("btn btn-success btn-small").find("span").addClass("icon-play"),this.removeButton.addClass("btn btn-danger btn-small").find("span").addClass("icon-minus-sign")); if(h.hasHtml4){c=this.AU.getParams(b,0,!1);h=d('<form action="'+e.url+'" method="post" target="ax-main-frame" encType="multipart/form-data" />').hide().appendTo(this.li);h.append(a);h.append('<input type="hidden" value="'+b+'" name="ax-file-name" />');for(a=0;a<c.length;a++)b=c[a].split("="),h.append('<input type="hidden" value="'+b[1]+'" name="'+b[0]+'" />');this.xhr=h}this.bindEvents();this.doPreview();e.hideUploadForm&&(null!==this.AU.form&&void 0!==this.AU.form)&&this.uploadButton.hide()};g.prototype.sizeFormat= function(){var a=this.size;"undefined"==typeof precision&&(precision=2);for(var b=[f("Bytes"),f("KB"),f("MB"),f("GB")],c=0;1024<=a&&c<b.length-1;)a/=1024,c++;var e=Math.round(a),d=Math.pow(10,precision),a=Math.round(a*d%d);return e+"."+a+" "+b[c]};g.prototype.bindEvents=function(){this.uploadButton.bind("click",this,function(a){a.data.AU.settings.enable&&(2!=a.data.status?(a.data.startUpload(!1),d(this).addClass("ax-abort")):(a.data.stopUpload(),d(this).removeClass("ax-abort")))});this.removeButton.bind("click", this,function(a){a.data.AU.settings.enable&&a.data.AU.removeFile(a.data.pos)});this.AU.settings.editFilename&&this.nameContainer.bind("dblclick",this,function(a){if(a.data.AU.settings.enable){a.stopPropagation();var b=a.data.ext;a=a.data.name.replace("."+b,"");d(this).html('<input type="text" value="'+a+'" />.'+b)}}).bind("blur focusout",this,function(a){a.stopPropagation();var b=d(this).children("input").val();"undefined"!=typeof b&&(b=b.replace(/[|&;$%@"<>()+,]/g,"")+"."+a.data.ext,d(this).html(b), a.data.name=b,a.data.AU.hasAjaxUpload||a.data.xhr.children('input[name="ax-file-name"]').val(b))})};g.prototype.doPreview=function(){if(this.AU.hasAjaxUpload&&this.file.type.match(/image.*/)&&("jpg"==this.ext||"gif"==this.ext||"png"==this.ext)&&"undefined"!==typeof FileReader){var a=this.name,b=this;this.prevContainer.css("background","none");var c=this.prevImage,e=new FileReader;e.onload=function(e){c.css("cursor","pointer").attr("src",e.target.result).click(function(){var c=new Image;c.onload=function(){var c= Math.min(d(window).width()/this.width,(d(window).height()-100)/this.height),j=1>c?this.width*c:this.width,c=1>c?this.height*c:this.height,f=d(window).scrollTop()-20+(d(window).height()-c)/2,g=(d(window).width()-j)/2,f=d("#ax-box").css({top:f,height:c,width:j,left:g});f.children("img").attr({width:j,height:c,src:e.target.result});d("#ax-box-fn").find("span").html(a+" ("+b.sizeFormat()+")");f.fadeIn(500);d("#ax-box-shadow").css("height",d(document).height()).show()};c.src=e.target.result;d("#ax-box-shadow").css("z-index", 1E4);d("#ax-box").css("z-index",10001)})};e.readAsDataURL(this.file)}else this.prevContainer.addClass("ax-filetype-"+this.ext).children("img:first").remove()};g.prototype.startUpload=function(a){this.AU.upload_all=a;this.AU.settings.beforeUpload.call(this,this.name,this.file)&&(this.progressBar.css("width","0%"),this.progressPer.html("0%"),this.uploadButton.addClass("ax-abort"),this.status=2,this.AU.hasAjaxUpload?this.uploadAjax():this.AU.hasFlash?this.AU.uploading||(this.AU.uploading=!0,this.AU.flashObj.uploadFile(this.pos)): this.uploadStandard(a))};g.prototype.uploadAjax=function(){var a=this.AU.settings,b=this.file,c=this.currentByte,e=this.name,d=this.size,j=a.chunkSize,f=j+c,g=0>=d-f,l=b,k=f/j;this.xhr=new XMLHttpRequest;0==c&&this.AU.slots++;0==j?(l=b,g=!0):b.mozSlice?l=b.mozSlice(c,f):b.webkitSlice?l=b.webkitSlice(c,f):b.slice?l=b.slice(c,f):(l=b,g=!0);var n=this;this.xhr.upload.addEventListener("abort",function(){n.AU.slots--},!1);this.xhr.upload.addEventListener("progress",function(a){a.lengthComputable&&(a=Math.round(100* (a.loaded+k*j-j)/d),n.onProgress(a))},!1);this.xhr.upload.addEventListener("error",function(){n.onError(this.responseText)},!1);this.xhr.onreadystatechange=function(){if(4==this.readyState&&200==this.status)try{var a=JSON.parse(this.responseText);0==c&&(n.name=a.name,n.nameContainer.html(a.name));if(-1==parseInt(a.status))throw a.info;g?(n.AU.slots--,n.onFinish(a.name,a.size,a.status,a.info)):(n.currentByte=f,n.uploadAjax())}catch(b){n.AU.slots--,n.onError(b)}};var b=void 0!==window.FormData,m=navigator.userAgent.match(/Firefox\/(\d+)?/); if(null!==m&&6>=(null!==m&&void 0!==m[1]&&!isNaN(m[1])?parseFloat(m[1]):7))b=!1;if(null!==navigator.userAgent.match(/Opera\/(\d+)?/)&&(m=navigator.userAgent.match(/Version\/(\d+)?/),12.1>(void 0!==m[1]&&!isNaN(m[1])?parseFloat(m[1]):0)))b=!1;e=this.AU.getParams(e,d,!b);e.push("ax-start-byte="+c);e.push("ax-last-chunk="+g);if(b){b=new FormData;b.append("ax_file_input",l);for(l=0;l<e.length;l++)m=e[l].split("="),b.append(m[0],m[1]);this.xhr.open("POST",a.url,a.async);this.xhr.send(b)}else b=-1==a.url.indexOf("?")? "?":"&",this.xhr.open("POST",a.url+b+e.join("&"),a.async),this.xhr.setRequestHeader("Cache-Control","no-cache"),this.xhr.setRequestHeader("X-Requested-With","XMLHttpRequest"),this.xhr.setRequestHeader("Content-Type","application/octet-stream"),this.xhr.send(l)};g.prototype.uploadStandard=function(a){this.progressBar.css("width","50%");this.progressPer.html("50%");d("#ax-main-frame").unbind("load").bind("load",this,function(b){var c=null;this.contentDocument?c=this.contentDocument:this.contentWindow&& (c=this.contentWindow.document);try{var e=d.parseJSON(c.body.innerHTML);b.data.onProgress(100);b.data.onFinish(e.name,e.size,e.status,e.info)}catch(h){b.data.onError(c.body.innerHTML)}void 0!==a&&void 0!==b.data.AU.files[b.data.pos+1]&&b.data.AU.files[b.data.pos+1].startUpload(a)});this.xhr.submit()};g.prototype.stopUpload=function(){if(this.AU.hasAjaxUpload)null!==this.xhr&&(this.xhr.abort(),this.xhr=null);else if(this.AU.hasFlash)this.AU.flashObj.stopUpload(this.pos);else{var a=document.getElementById("ax-main-frame"); try{a.contentWindow.document.execCommand("Stop")}catch(b){a.contentWindow.stop()}}this.uploadButton.removeClass("ax-abort");this.status=this.currentByte=0;this.progressBar.css("width",0);this.progressPer.html(f("Upload aborted"))};g.prototype.onError=function(a){this.currentByte=0;this.status=-1;this.info=a;this.progressPer.html(a);this.progressBar.css("width","0%");this.uploadButton.removeClass("ax-abort");this.AU.settings.error.call(this,a,this.name);this.AU.settings.removeOnError&&this.AU.removeFile(this.pos)}; g.prototype.onFinish=function(a,b,c,e){this.name=a;this.status=parseInt(c);this.info=e;!this.AU.hasAjaxUpload&&!this.AU.hasFlash&&(this.size=b,b=this.sizeFormat(),this.sizeContainer.html(b));this.currentByte=0;this.nameContainer.html(a);this.li.attr("title",a);this.onProgress(100);this.uploadButton.removeClass("ax-abort");this.progressBar.width(0);this.progressPer.html(f("File uploaded 100%"));this.AU.settings.success.call(this,a);a=!0;for(b=0;b<this.AU.files.length;b++)1!=this.AU.files[b].status&& -1!=this.AU.files[b].status&&(a=!1);a&&!this.AU.finis_has_run&&(this.AU.finish(),this.AU.finis_has_run=!0);this.AU.settings.removeOnSuccess&&this.AU.removeFile(this.pos)};g.prototype.onProgress=function(a){this.progressBar.css("width",a+"%");this.progressPer.html(a+"%")};var k=function(a,b){var c=document.createElement("input");c.type="file";this.hasAjaxUpload="multiple"in c&&"undefined"!=typeof File&&"undefined"!=typeof(new XMLHttpRequest).upload;this.hasFlash=!1;/Safari/.test(navigator.userAgent)&& (/Apple Computer/.test(navigator.vendor)&&/Version\/5\./.test(navigator.userAgent)&&/Win/.test(navigator.platform))&&(this.hasAjaxUpload=!1);if(!this.hasAjaxUpload)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")&&(this.hasFlash=!0)}catch(e){void 0!=navigator.mimeTypes["application/x-shockwave-flash"]&&(this.hasFlash=!0)}this.hasHtml4=!this.hasFlash&&!this.hasAjaxUpload;this.$this=a;this.files=[];this.slots=0;this.settings=b;this.fieldSet=d("<fieldset />").append('<legend class="ax-legend">'+ f("Select Files")+"</legend>").appendTo(a);this.form_submit_event=this.form=null;this.finis_has_run=!1;this.flashObj=null;this.uploading=this.upload_all=!1;this.max_size=b.maxFileSize;c=b.maxFileSize.slice(-1);if(isNaN(c))switch(this.max_size=this.max_size.replace(c,""),c){case "T":this.max_size*=1024;case "G":this.max_size*=1024;case "M":this.max_size*=1024;case "K":this.max_size*=1024}var h="ax-browse-c ax-button",c="ax-upload-all ax-button",j="ax-clear ax-button",g="ax-plus-icon ax-icon",k="ax-upload-icon ax-icon", l="ax-clear-icon ax-icon";b.bootstrap&&(h+=" btn btn-primary",c+=" btn btn-success",j+=" btn btn-danger",g+=" icon-plus-sign",k+=" icon-play",l+=" icon-remove-sign");this.browse_c=d('<a class="'+h+'" title="'+f("Add files")+'" />').append('<span class="'+g+'"></span> <span class="ax-text">'+f("Add files")+"</span>").appendTo(this.fieldSet);this.browseFiles=d('<input type="file" class="ax-browse" name="ax_file_input" />').attr("multiple",this.hasAjaxUpload).appendTo(this.browse_c);b.uploadDir&&this.browseFiles.attr({directory:"directory", webkitdirectory:"webkitdirectory",mozdirectory:"mozdirectory"});this.hasFlash&&(this.browse_c.children(".ax-browse").remove(),h=a.attr("id")+"_flash",g='\x3c!--[if !IE]> --\x3e<object style="position:absolute;width:150px;height:100px;left:0px;top:0px;z-index:1000;" id="'+h+'" type="application/x-shockwave-flash" data="'+b.flash+'" width="150" height="100">\x3c!-- <![endif]--\x3e\x3c!--[if IE]><object style="position:absolute;width:150px;height:100px;left:0px;top:0px;z-index:1000;" id="'+h+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0" width="150" height="100"><param name="movie" value="'+ b.flash+'" />\x3c!--\x3e\x3c!--dgx--\x3e<param name="flashvars" value="instance_id='+a.attr("id")+'"><param name="allowScriptAccess" value="always" /><param value="transparent" name="wmode"></object>\x3c!-- <![endif]--\x3e',this.browse_c.append('<div style="position:absolute;overflow:hidden;width:150px;height:100px;left:0px;top:0px;z-index:0;">'+g+"</div>"),this.flashObj=document.getElementById(h));this.uploadFiles=d('<a class="'+c+'" title="'+f("Upload all files")+'" />').append('<span class="'+ k+'"></span> <span>'+f("Start upload")+"</span>").appendTo(this.fieldSet);this.removeFiles=d('<a class="'+j+'" title="'+f("Remove all")+'" />').append('<span class="'+l+'"></span> <span>'+f("Remove all")+"</span>").appendTo(this.fieldSet);this.fileList=d('<ul class="ax-file-list" />').appendTo(this.fieldSet);b.bootstrap&&this.fileList.addClass("media-list");b.onInit.call(this,this);this.bindEvents(a)};k.prototype.bindEvents=function(a){var b=this.settings;this.browseFiles.bind("change",this,function(a){a.data.settings.enable&& !a.data.hasFlash&&(a.data.addFiles(a.data.hasAjaxUpload?this.files:Array(this)),a.data.hasAjaxUpload||d(this).clone(!0).val("").appendTo(a.data.browse_c),this.value="")});this.uploadFiles.bind("click",this,function(a){a.data.settings.enable&&a.data.uploadAll();return!1});this.removeFiles.bind("click",this,function(a){a.data.settings.enable&&a.data.clearQueue();return!1});0<d(b.form).length?this.form=d(b.form):"parent"==b.form&&(this.form=a.parents("form:first"));if(null!==this.form&&void 0!==this.form){b.hideUploadForm&& this.uploadFiles.hide();var c=this.form.data("events");null!==c&&void 0!==c&&(null!==c.submit&&void 0!==c.submit)&&(this.form_submit_event=c.submit);this.form.unbind("submit");this.form.bind("submit.ax",this,function(a){if(0<a.data.files.length)return a.data.uploadAll(),!1})}if(this.hasAjaxUpload){a="self"==b.dropArea?a[0]:d(b.dropArea)[0];var e=this;"self"==b.dropArea&&this.fieldSet.find(".ax-legend").html(f("Select Files or Drag&Drop Files"));a.addEventListener("dragenter",function(a){a.stopPropagation(); a.preventDefault()},!1);a.addEventListener("dragover",function(a){a.stopPropagation();a.preventDefault();e.settings.enable&&(b.dropClass?d(this).addClass(b.dropClass):this.style.backgroundColor=b.dropColor)},!1);a.addEventListener("dragleave",function(a){a.stopPropagation();a.preventDefault();e.settings.enable&&(b.dropClass?d(this).removeClass(b.dropClass):this.style.backgroundColor="")},!1);a.addEventListener("drop",function(a){e.settings.enable&&(a.stopPropagation(),a.preventDefault(),e.addFiles(a.dataTransfer.files), this.style.backgroundColor="",b.autoStart&&e.uploadAll())},!1);d(document).unbind(".ax").bind("keyup.ax",function(a){27==a.keyCode&&d("#ax-box-shadow, #ax-box").fadeOut(500)})}this.enable(this.settings.enable)};k.prototype.finish=function(){for(var a=[],b=0;b<this.files.length;b++)a.push(this.files[b].name);this.settings.finish.call(this,a,this.files);this.settings.beforeSubmit.call(this,a,this.files,function(){if(null!==this.form&&void 0!==this.form){for(var b="function"==typeof this.settings.remotePath? this.settings.remotePath():this.settings.remotePath,e=0;e<a.length;e++)this.form.append('<input name="ax-uploaded-files[]" type="hidden" value="'+(b+a[e])+'" />');this.form.unbind("submit.ax");null!==this.form_submit_event&&void 0!==this.form_submit_event&&this.form.bind("submit",this.form_submit_event);b=this.form.find('[type="submit"]');0<b.length?b.trigger("click"):this.form.submit()}})};k.prototype.addFiles=function(a){for(var b=0;b<a.length;b++){var c,e,d;this.hasAjaxUpload||this.hasFlash?(e= a[b].name,d=a[b].size):(e=a[b].value.replace(/^.*\\/,""),d=0);c=e.split(".").pop().toLowerCase();var j=this.checkFile(e,d);""==j?(c=new g(a[b],e,d,c,this),this.files.push(c)):this.settings.error.call(this,j,e)}this.settings.onSelect.call(this,this.files);this.settings.autoStart&&this.uploadAll()};k.prototype.checkFile=function(a,b){var c=a.split(".").pop().toLowerCase(),e=!!(this.files.length<this.settings.maxFiles),h=!!(0<=d.inArray(c,this.settings.allowExt)||0==this.settings.allowExt.length),j= !!(b<=this.max_size),g="";e||(g=+f("Max files number reached")+":"+e+"\n");h||(g=+f("Extension not allowed")+":"+c+"\n");j||(g=+f("File size now allowed")+":"+b+"\n");return g};k.prototype.uploadAll=function(){if(!1!==this.settings.beforeUploadAll.call(this,this.files)){for(var a=!1,b=!1,c=0;c<this.files.length;c++)0==this.files[c].status&&(a=!0,b||(b=this.files[c]));if(a)if(this.hasAjaxUpload){var e=this;setTimeout(function(){for(var a=!0,b=0;b<e.files.length;b++)0==e.files[b].status&&(a=!1,e.slots<= e.settings.maxConnections&&e.files[b].startUpload(!1));a||e.uploadAll()},300)}else b&&b.startUpload(!0)}};k.prototype.clearQueue=function(){for(;0<this.files.length;)this.removeFile(0)};k.prototype.getParams=function(a,b,c){var e=this.settings,d="function"==typeof e.remotePath?e.remotePath():e.remotePath,f=[];f.push("ax-file-path="+(c?encodeURIComponent(d):d));f.push("ax-allow-ext="+(c?encodeURIComponent(e.allowExt.join("|")):e.allowExt.join("|")));f.push("ax-file-name="+(c?encodeURIComponent(a): a));f.push("ax-max-file-size="+e.maxFileSize);f.push("ax-file-size="+b);f.push("ax-thumbPostfix="+(c?encodeURIComponent(e.thumbPostfix):e.thumbPostfix));f.push("ax-thumbPath="+(c?encodeURIComponent(e.thumbPath):e.thumbPath));f.push("ax-thumbFormat="+(c?encodeURIComponent(e.thumbFormat):e.thumbFormat));f.push("ax-thumbHeight="+e.thumbHeight);f.push("ax-thumbWidth="+e.thumbWidth);a="function"==typeof e.data?e.data():e.data;if("object"==typeof a)for(var g in a)f.push(g+"="+(c?encodeURIComponent(a[g]): a[g]));else"string"==typeof a&&""!=a&&f.push(a);return f};k.prototype.removeFile=function(a){var b=this.files[a];b.stopUpload();b.li.remove();b.file=null;this.files.splice(a,1);this.hasFlash&&this.flashObj.removeFile(a);for(a=0;a<this.files.length;a++)this.files[a].pos=a};k.prototype.options=function(a,b){if(void 0!==b&&null!==b)this.settings[a]=b,"enable"==a&&this.enable(b);else return this.settings[a]};k.prototype.enable=function(a){(this.settings.enable=a)?this.$this.removeClass("ax-disabled").find("input").attr("disabled", !1):this.$this.addClass("ax-disabled").find("input").attr("disabled",!0)};var t={remotePath:"uploads/",url:"upload.php",flash:"uploader.swf",data:"",async:!0,maxFiles:9999,allowExt:[],success:function(){},finish:function(){},error:function(){},enable:!0,chunkSize:1048576,maxConnections:3,dropColor:"red",dropClass:"ax-drop",dropArea:"self",autoStart:!1,thumbHeight:0,thumbWidth:0,thumbPostfix:"_thumb",thumbPath:"",thumbFormat:"",maxFileSize:"10M",form:null,hideUploadForm:!0,beforeSubmit:function(a, b,c){c.call(this)},editFilename:!1,beforeUpload:function(){return!0},beforeUploadAll:function(){return!0},onSelect:function(){},onInit:function(){},language:"auto",uploadDir:!1,removeOnSuccess:!1,removeOnError:!1,bootstrap:!1},q={init:function(a){return this.each(function(){var b=d.extend({},t,a),c=d(this).html(""),e=c.data("AU");if(!(void 0!==e&&null!==e)){"auto"==b.language&&(b.language=(window.navigator.userLanguage||window.navigator.language).replace("-","_"));p=s[b.language];c.addClass("ax-uploader").data("author", "http://www.albanx.com/");0==d("#ax-main-frame").length&&d('<iframe name="ax-main-frame" id="ax-main-frame" />').hide().appendTo("body");0==d("#ax-box").length&&d('<div id="ax-box"><div id="ax-box-fn"><span></span></div><img /><a id="ax-box-close" title="'+f("Close")+'"></a></div>').appendTo("body");0==d("#ax-box-shadow").length&&d('<div id="ax-box-shadow"/>').appendTo("body");d("#ax-box-close, #ax-box-shadow").click(function(a){a.preventDefault();d("#ax-box").fadeOut(500);d("#ax-box-shadow").hide()}); b.bootstrap&&d("#ax-box-close").addClass("btn btn-danger").html('<span class="ax-clear-icon ax-icon icon-remove-sign"></span>');for(e="AX_"+Math.floor(100001*Math.random());0<d("#"+e).length;)e="AX_"+Math.floor(100001*Math.random());this.id=this.id?this.id:e;b.allowExt=d.map(b.allowExt,function(a){return a.toLowerCase()});c.data("AU",new k(c,b))}})},clear:function(){return this.each(function(){d(this).data("AU").clearQueue()})},start:function(){return this.each(function(){d(this).data("AU").uploadAll()})}, addFlash:function(a){d(this).data("AU").addFiles(a)},progressFlash:function(a,b){d(this).data("AU").files[b].onProgress(a)},onFinishFlash:function(a,b){var c=d(this).data("AU");c.uploading=!1;try{var e=jQuery.parseJSON(a);if(-1==parseInt(e.status))throw e.info;c.files[b].onFinish(e.name,e.size,e.status,e.info)}catch(f){c.files[b].onError(f)}if(c.upload_all)for(e=!0;e;)b++,void 0!==c.files[b]&&0==c.files[b].status?(e=!1,c.files[b].startUpload(c.upload_all)):e=void 0!==c.files[b]&&0!=c.files[b].status? !0:!1},getUrl:function(){return d(this).data("AU").settings.url},getParams:function(a,b){return d(this).data("AU").getParams(a,b,!0).join("&")},getAllowedExt:function(a){var b=d(this).data("AU").settings.allowExt;return!0===a?b:b.join("|")},getMaxFileNum:function(){return d(this).data("AU").settings.maxFiles},checkFile:function(a,b){return""==d(this).data("AU").checkFile(a,b)},checkEnable:function(){return d(this).data("AU").settings.enable},getFiles:function(){return d(this).data("AU").files},enable:function(){return this.each(function(){d(this).data("AU").enable(!0)})}, disable:function(){return this.each(function(){d(this).data("AU").enable(!1)})},destroy:function(){return this.each(function(){var a=d(this);a.data("AU").clearQueue();a.removeData("AU").html("")})},option:function(a,b){return this.each(function(){return d(this).data("AU").options(a,b)})},debug:function(a){console.log(a)}};d.fn.ajaxupload=function(a,b){if(q[a])return q[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"===typeof a||!a)return q.init.apply(this,arguments);d.error("Method "+ a+" does not exist on jQuery.AjaxUploader")}})(jQuery);